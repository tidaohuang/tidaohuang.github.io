<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_51) on Thu Nov 21 01:56:53 IST 2019 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>wt.fc.batch (WNC.HORSE.10.00.602)</title>
<meta name="date" content="2019-11-21">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="wt.fc.batch (WNC.HORSE.10.00.602)";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../wt/fc/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../../wt/fc/collections/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?wt/fc/batch/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;wt.fc.batch</h1>
<div class="docSummary">
<div class="block">Provides a mechanism for specifying operations that affect mulitple objects in the
persistent datastore.</div>
</div>
<p>See:&nbsp;<a href="#package.description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../wt/fc/batch/AbstractBatchSpec.html" title="class in wt.fc.batch">AbstractBatchSpec</a></td>
<td class="colLast">
<div class="block">This class specifies the contract for processing multiple row update
 and delete operations.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../wt/fc/batch/DeleteBatchSpec.html" title="class in wt.fc.batch">DeleteBatchSpec</a></td>
<td class="colLast">
<div class="block">This class implements processing multiple row delete  operations.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../wt/fc/batch/UpdateBatchSpec.html" title="class in wt.fc.batch">UpdateBatchSpec</a></td>
<td class="colLast">
<div class="block">This class implements processing multiple row update  operations.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../wt/fc/batch/UpdateColumnExpression.html" title="class in wt.fc.batch">UpdateColumnExpression</a></td>
<td class="colLast">
<div class="block">This class specifies a ClassAttribute and associate expression that is
 used for batch specficiation update.</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package.description">
<!--   -->
</a>
<h2 title="Package wt.fc.batch Description">Package wt.fc.batch Description</h2>
<div class="block">Provides a mechanism for specifying operations that affect mulitple objects in the
persistent datastore.

<p>
A batch specification operation is executed using the 
<code>wt.fc.PersistenceManagerSvr#execute(wt.fc.batch.BatchSpec)</code> method and directly 
modifies the persistent state of objects in the datastore.  Events
associated with create, update and delete are not guaranteed to be generated when a batch specification
is executed. Any in-memory Persistable objects are not affected.  Therefore, when using this 
functionality, care must be taken to ensure that any in-memory objects are refreshed to avoid 
stale exceptions.  In terms of performance, this functionality should generally only be used 
when refreshing the target objects is not necessary.   
</p>
<p>
The target of update and delete batch specification operation is specified using a 
<a href="../../../wt/query/ClassTableExpression.html" title="class in wt.query"><code>ClassTableExpression</code></a>.  The <a href="../../../wt/query/AbstractClassTableExpression.html#setExcludedDescendants-java.util.List-"><code>AbstractClassTableExpression.setExcludedDescendants(java.util.List)</code></a>, 
<a href="../../../wt/query/AbstractClassTableExpression.html#setDescendantsIncluded-boolean-"><code>AbstractClassTableExpression.setDescendantsIncluded(boolean)</code></a>, and 
<a href="../../../wt/query/AbstractClassTableExpression.html#setIncludedInterfaces-java.util.List-"><code>AbstractClassTableExpression.setIncludedInterfaces(java.util.List)</code></a> methods can all be used to 
further specify which concrete sub-classes and associated tables are affected.
</p>

<H3>
Insert
</H3>
<p>
Datastore tables can be populated with a query to select multiple rows of insert values using the 
<code>wt.fc.batch.InsertBatchSpec</code>.  The general pattern for constructing an InsertBatchSpec
and executing it is as follows.
<ol>
<li>
Create an InsertBatchSpec object.
</li>
<li>
Set the target table using <code>wt.fc.batch.InsertBatchSpec#setTarget</code> and 
<code>wt.fc.batch.InsertTableExpression</code>.
</li>
<li>
Set the columns to insert using <code>wt.fc.batch.InsertBatchSpec#setColumns</code>
and <code>wt.fc.batch.InsertColumnExpression</code>.
</li>
<li>
Set the statement sub-select query using <code>wt.fc.batch.InsertBatchSpec#setStatement</code> and
<a href="../../../wt/pds/StatementSpec.html" title="interface in wt.pds"><code>StatementSpec</code></a>.
</li>
<li>
Execute the InsertBatchSpec object using <code>wt.fc.PersistenceManagerSvr#execute(wt.fc.batch.BatchSpec)</code> .
</li>
</ol>
</p>
<p>
Example:
<code><pre>
InsertBatchSpec batchSpec = new InsertBatchSpec(); 

batchSpec.setTarget(new InsertTableExpression("MyCustomerTable"));

InsertColumnExpression[] insertColumns = new InsertColumnExpression[1];
insertColumns[0] = new InsertColumnExpression("NAME");
batchSpec.setColumns(insertColumns);

QuerySpec query = new QuerySpec();
int index = query.appendClassList(Customer.class, false /* do not select */); 
query.appendSelect(new ClassAttribute(Customer.class, Customer.NAME), new int[] { index }, true /* select only */);
batchSpec.setStatement(query);

int count = PersistenceServerHelper.manager.execute(batchSpec);
</pre></code>
</p>
<p>
Note that the number of insert columns and their types must be compatible with the columns selected by the
statement.
</p>

<H3>
Update
</H3>
<p>
Persistable objects that are already persisted in the datastore can be updated using the 
<a href="../../../wt/fc/batch/UpdateBatchSpec.html" title="class in wt.fc.batch"><code>UpdateBatchSpec</code></a>.  The general pattern for constructing an UpdateBatchSpec
and executing it is as follows.
<ol>
<li>
Create an UpdateBatchSpec object.
</li>
<li>
Set the target class using <a href="../../../wt/fc/batch/AbstractBatchSpec.html#setTarget-wt.query.ClassTableExpression-"><code>AbstractBatchSpec.setTarget(wt.query.ClassTableExpression)</code></a> and <a href="../../../wt/query/ClassTableExpression.html" title="class in wt.query"><code>ClassTableExpression</code></a>.
</li>
<li>
Set the columns and associated values to update using <a href="../../../wt/fc/batch/UpdateBatchSpec.html#setUpdateColumns-wt.fc.batch.UpdateColumnExpression:A-"><code>UpdateBatchSpec.setUpdateColumns(wt.fc.batch.UpdateColumnExpression[])</code></a>
and <a href="../../../wt/fc/batch/UpdateColumnExpression.html" title="class in wt.fc.batch"><code>UpdateColumnExpression</code></a>.
</li>
<li>
Set or add criteria to specify the objects in the persistent datastore that will be affected using
<a href="../../../wt/fc/batch/AbstractBatchSpec.html#setWhere-wt.query.WhereExpression-"><code>AbstractBatchSpec.setWhere(wt.query.WhereExpression)</code></a> or <a href="../../../wt/fc/batch/AbstractBatchSpec.html#appendWhere-wt.query.WhereExpression-wt.query.LogicalOperator-"><code>AbstractBatchSpec.appendWhere(wt.query.WhereExpression, wt.query.LogicalOperator)</code></a>, respectively.
</li>
<li>
Execute the UpdateBatchSpec object using <code>wt.fc.PersistenceManagerSvr#execute(wt.fc.batch.BatchSpec)</code> .
</li>
</ol>
</p>
<p>
Example:
<code><pre>
UpdateBatchSpec batchSpec = new UpdateBatchSpec(); 

batchSpec.setTarget(new ClassTableExpression(Customer.class));

ClassAttribute nameAttribute = new ClassAttribute(Customer.class, Customer.NAME);
UpdateColumnExpression[] updateColumns = new UpdateColumnExpression[1];
updateColumns[0] = new UpdateColumnExpression(nameAttribute, new ConstantExpression("SMITH"));
batchSpec.setUpdateColumns(updateColumns);

SearchCondition criteria = new SearchCondition(nameAttribute, SearchCondition.EQUAL, new ConstantExpression("smith"));
batchSpec.setWhere(criteria);

int count = PersistenceServerHelper.manager.execute(batchSpec);
</pre></code>
</p>
<p>
Steps #1-4 can be combined using the single call to the constructor 
<a href="../../../wt/fc/batch/UpdateBatchSpec.html#UpdateBatchSpec-wt.query.ClassTableExpression-wt.query.WhereExpression-wt.fc.batch.UpdateColumnExpression:A-"><code>UpdateBatchSpec.UpdateBatchSpec(wt.query.ClassTableExpression,wt.query.WhereExpression,UpdateColumnExpression[])</code></a>.
</p>
<p>
The persistence service updates the affected objects' persistence attributes in the datastore.  The &quot;thePersistInfo.updateCount&quot; 
attribute is incremented by 1.  If &quot;thePersistInfo.updateStamp&quot; is specified in the UpdateColumnExpressions list, then the specified 
update value will be set, otherwise, it is set to the MethodServer's current time.  If any of the following attributes are specified 
in the UpdateColumnExpressions list, then an exception will be thrown.
<ul>
<li>
thePersistInfo.theObjectIdentifier.id
</li>
<li>
thePersistInfo.theObjectIdentifier.classname
</li>
<li>
thePersistInfo.updateCount
</li>
</ul>
</p>

<H3>
Delete
</H3>
<p>
Persistable objects that are already persisted in the datastore can be deleted using the 
<a href="../../../wt/fc/batch/DeleteBatchSpec.html" title="class in wt.fc.batch"><code>DeleteBatchSpec</code></a>.  The general pattern for constructing a DeleteBatchSpec
and executing it is as follows.
<ol>
<li>
Create a DeleteBatchSpec object.
</li>
<li>
Set the target class using <a href="../../../wt/fc/batch/AbstractBatchSpec.html#setTarget-wt.query.ClassTableExpression-"><code>AbstractBatchSpec.setTarget(wt.query.ClassTableExpression)</code></a> and <a href="../../../wt/query/ClassTableExpression.html" title="class in wt.query"><code>ClassTableExpression</code></a>.
</li>
<li>
Set or add criteria to specify the objects in the persistent datastore that will be affected using
<a href="../../../wt/fc/batch/AbstractBatchSpec.html#setWhere-wt.query.WhereExpression-"><code>AbstractBatchSpec.setWhere(wt.query.WhereExpression)</code></a> or <a href="../../../wt/fc/batch/AbstractBatchSpec.html#appendWhere-wt.query.WhereExpression-wt.query.LogicalOperator-"><code>AbstractBatchSpec.appendWhere(wt.query.WhereExpression, wt.query.LogicalOperator)</code></a>, respectively.
</li>
<li>
Execute the DeleteBatchSpec object using <code>wt.fc.PersistenceManagerSvr#execute(wt.fc.batch.BatchSpec)</code> .
</li>
</ol>
</p>
<p>
Example:
<code><pre>
DeleteBatchSpec batchSpec = new DeleteBatchSpec(); 

batchSpec.setTarget(new ClassTableExpression(Customer.class));

ClassAttribute nameAttribute = new ClassAttribute(Customer.class, Customer.NAME);
SearchCondition criteria = new SearchCondition(nameAttribute, SearchCondition.EQUAL, new ConstantExpression("smith"));
batchSpec.setWhere(criteria);

int count = PersistenceServerHelper.manager.execute(batchSpec);
</pre></code>
</p>
<p>
Steps #1-3 can be combined using the single call to the constructor 
<a href="../../../wt/fc/batch/DeleteBatchSpec.html#DeleteBatchSpec-wt.query.ClassTableExpression-wt.query.WhereExpression-"><code>DeleteBatchSpec.DeleteBatchSpec(wt.query.ClassTableExpression,wt.query.WhereExpression)</code></a>.
</p>
<p>
If necessary, the persistence service will also perform referential integrity processing on the affected objects.  The
processing is identical to retrieving the affected objects from the datastore and executing 
<a href="../../../wt/fc/PersistenceManagerSvr.html#remove-wt.fc.collections.WTSet-"><code>PersistenceManagerSvr.remove(wt.fc.collections.WTSet)</code></a> on the affected objects.
</p></div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../wt/fc/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../../wt/fc/collections/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?wt/fc/batch/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
